# Queries on Data [P5]

In order to select particular data within a database, one can use queries. Queries are a tool that allow for pieces of information to be extracted from large volumes of data, and are a key feature of database software.

## Basic Queries

<div class="i">
	<img src="/btec/img/18.2.1.01.png">
	Queries are created in Access by entering the <em>Query Design</em> mode.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.1.02.png">
	A list of tables and other queries are shown, and can be imported into the new query as sources of data.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.1.03.png">
	For the first query I created, I added three fields from two different tables, and added a fourth column containing an expression.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.1.04.png">
	The above expression is used to multiply the values of two columns to generate a total collected revenue for each car in a fictional car-hire company's fleet.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.1.05.png">
	The last column, containing the expression, was used to sort the data, meaning that the highest-earning car would be at the top of the data generated by the query when run.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>

## Crosstab Queries

<div class="i">
	<img src="/btec/img/18.2.2.01.png">
	More advanced types of queries can also be created within Access. For example, the Crosstab query can be used for more complex queries containing more data.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.2.02.png">
	A single table is used when creating a Crosstab query.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.2.03.png">
	I used a single field from the table to use as headings for the final output's rows.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.2.04.png">
	I picked another, the date, for the headings of columns.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.2.05.png">
	Using the built-in presets for managing time-based data, I requested to be shown data split in to quarterly (three-month) sections.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.2.06.png">
	Access can be configured to summarise data in a number of different ways, and the counting function was used to calculate the number of sessions each car had been used for.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.2.07.png">
	The last step of the Crosstab Query Wizard allows one to enter a name for the new query. The query I created was name according to the naming convention I had used before.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>

## Conditional Queries

When the previously-detailed query times aren't sufficient, one can use conditional queries. These require data to be given to the software before the query is run, and this data is used to gather specific results.

<div class="i">
	<img src="/btec/img/18.2.3.01.png">
	The <code>tbl_sessions</code> table was imported in order to query information about the drivers occupied on particular dates.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.3.02.png">
	I used three fields from the table; the unique driver identifier, date of a session, and time of a session during the day.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.3.03.png">
	Parameters used when the query is run can be configured by opening the <em>Parameters</em> dialogue box.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.3.04.png">
	Two parameters were added for the query; the date of a session and the time during the day.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.3.05.png">
	The values of the parameters were used in the design of the query, which will only show records matching the data given to it prior to execution.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.3.06.png">
	Finally, the query is given a name and saved.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.3.07.png">
	When the query is run, Access will prompt the user to enter a particular data and time, and the database will return data accordingly.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.3.08.png">
	The query will only show the records in the sessions table which match both the data and time of day specified before run-time.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.3.09.png">
	A new query is then created, starting with the original query, plus another table to provide more human-readable information.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.3.10.png">
	Next, the fields containing linked information in each of the tables are joined by dragging from one to the other.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.3.11.png">
	The new relationship join is right-clicked, giving access to its configuration. The relationship is altered so that all of the data from one table is shown, despite it not all matching the data in the other.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.3.12.png">
	Next, the Expression Builder in Access is used to create a fourth column, containing an expression. This is used to determine whether a driver is free or not, based on the given information, and printing this information as a table column.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.3.14.png">
	The query successfully shows a list of the drivers used by the company and whether or not each driver will be, is, or was free during a particular time slot on a particular day.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.3.15.png">
	To make the query more accessible and conveniently placed, one can add a button to a form which will take the user to a query and run it. A button was created on the bookings form to check the availability of drivers on certain days. The same process was completed for vehicles as well as drivers.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.3.16.png">
	Once the button has been created and the option to run a query selected, the query to run must be chosen.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.3.17.png">
	One can show either text or an image on the button, and I opted for the former to avoid confusion.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.3.18.png">
	Lastly, the button is named to name it easier to identify in a list of form objects.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>

# Test a Relational Database [P7]

## Prevention of Accidental Record Removal

<div class="i">
	<img src="/btec/img/18.2.6.01.png">
	The option to delete a record is shown in Access and can be clicked.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.6.02.png">
	If the user proceeds, however, they'll be met with an error message, informing them that enforced referential integrity prevents record deletion. In the case of a driver being deleted, all sessions referring to the driver must first be removed. An organisation would likely rather simply mark the driver as inactive than do this.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>

# Interpreting Data [M3]

In order to make the data more accessible and easier to work with, the results from each of the queries (other than the conditional query) was exported to Excel.

## Exporting to Excel

<div class="i">
	<img src="/btec/img/18.2.4.01.png">
	Data in Access cannot be manipulated in the same way as it can in Excel, providing a reason to export this query, for instance.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.4.02.png">
	To export, once must right-click the name of the query in the left panel, and then click Excel within the Export sub-menu.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.4.03.png">
	Access allows the user to select a save location for the newly generated spreadsheet, as well as a format other than Excel's if they wish. There are further options which may be used in some cases.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.4.04.png">
	Once the export process is complete in Access, the program allows the user to save the export steps for later, which can make bulk exporting much easier.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.4.05.png">
	Once the data has been exported, the new spreadsheet can be opened in Excel.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.4.06.png">
	The screenshot shows the potential for the use of Excel features on the data set.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.4.07.png">
	Using the Move or Copy functionality in Excel, I began placing each query's export within one multi-sheet document, rather than keeping each a separate file.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.4.08.png">
	The sheets were all moved to a single new workbook I created.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>

## Representation of Data

<div class="i">
	<img src="/btec/img/18.2.5.01.png">
	Using the various graphing tools available in Excel, one can quickly create rich visual representations of data.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.5.03.png">
	A graph showing the number of sessions that each car was used for. The single session for the car PU04NCV can be counted as an anomaly and likely a result of a mistake in record keeping.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.5.04.png">
	The data can also be represented in a pie chart, using percentages to show the spread of duty among the vehicles.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.5.05.png">
	A graph showing the spread of work across the different vehicles, with respect to the three quarters with data available.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.5.06.png">
	A graph showing the spread of work among the vehicles, showing the exact values above each column.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.5.07.png">
	A graph showing the amount of sessions completed by cars of particular manufactures. This data could be very useful when deciding upon a new car purchase.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.5.08.png">
	A graph showing the popularity of cars based on their maximum passenger capacity and the number of sessions completed. This too could be useful information when making a new purchase.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>
<div class="i">
	<img src="/btec/img/18.2.5.09.png">
	A graph showing the sessions completed with certain passenger group sizes, something useful for gauging how people most often travel.
	<div>Image by me; see <a href="/btec/license">license</a>.</div>
</div>

# Evaluation of Database [D2]

## Data Validation and Input

Validation was used on the input forms in order to prevent users from entering invalid data. Input masks and data validation rules in Access were both used. The process of configuring these was detailed in the [first assignment](/btec/18.1).

## Double Booking

The creation of a conditional query allows users of the database to check the availability of both drivers and vehicles given a data and a time of day. Precautions have not been implemented, however, to prevent the entry of conflicting records. This is a feature which would still need to be added to the database in a business environment.

<sup><sup>I haven't the will to continue.</sup></sup>
